# ═══════════════════════════════════════════════════════════════
#  VM 2 — API Gateway (2 vCPU, 2-4 GB RAM)
# ═══════════════════════════════════════════════════════════════
#
#  Same VM as core:  docker compose -f docker-compose.dashboard.yml up -d
#  Separate VM:      Set REDIS_ADDR=<VM1_IP>:6379 in .env first
#
#  API Gateway will be available at http://localhost:9090
#  React Frontend: run `cd frontend && npm run dev` → http://localhost:5173

services:
  api_gateway:
    build:
      context: .
      dockerfile: Dockerfile
    image: trading-system:latest
    container_name: ts-api-gateway
    command: api_gateway
    restart: always
    env_file: .env
    environment:
      - REDIS_ADDR=localhost:6379
      - REDIS_PASSWORD=${REDIS_PASSWORD:-}
      - GATEWAY_ADDR=:9090
    network_mode: host
